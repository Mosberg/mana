# Copilot Instructions for Mana System (Fabric Mod)

## Project Overview

- **Mana System** is a Minecraft 1.21.10 Fabric mod for managing player mana pools, overlays, and configuration.
- The codebase is split into main (game logic, config) and client (HUD overlays, rendering) modules.
- Key entrypoints: `Mana` (main mod, src/main/java/dk/mosberg/Mana.java) and `ManaClient` (client mod, src/client/java/dk/mosberg/client/ManaClient.java).

## Architecture & Patterns

- **Mana Logic:**
  - Core classes: `ManaPool`, `ManaComponent`, `ManaComponents` (src/main/java/dk/mosberg/mana/)
  - Each player has a `ManaComponent` with a `ManaPool` (primary, secondary, tertiary mana).
  - Use `ManaComponents.get(ServerPlayerEntity)` to access a player's mana.
- **Configuration:**
  - Centralized in `ManaConfig` (src/main/java/dk/mosberg/config/ManaConfig.java), supports runtime updates and JSON persistence.
- **Client Rendering:**
  - HUD overlays in `overlay/` (src/client/java/dk/mosberg/client/overlay/), e.g., `ManaHudOverlay` draws mana bars above the health bar.
  - Rendering helpers in `renderer/` (src/client/java/dk/mosberg/client/renderer/).

## Developer Workflows

- **Build:**
  - Use Gradle: `./gradlew build` (Windows: `gradlew.bat build`).
  - JVM args and build optimizations are set in `README.md` and `gradle.properties`.
- **Run/Debug:**
  - Client: `./gradlew runClient` (runs Minecraft with the mod in dev mode).
  - Server: `./gradlew runServer`.
  - IDE run configs are generated by Fabric Loom.
- **Test:**
  - JUnit 5 tests: `./gradlew test`.
- **Custom Tasks:**
  - `./gradlew projectInfo` prints mod/build info.

## Conventions & Integration

- **Fabric API** and **Yarn mappings** are used for Minecraft integration.
- **Component pattern** for player data (see `ManaComponent`).
- **Overlay rendering** is modular; new overlays should follow the `ManaHudOverlay` pattern.
- **Config keys** are dot-separated (e.g., `magic.spell.manaCost.multiplier`).
- **Resource files** (textures, mod metadata) are in `src/main/resources/`.

## Key Files & Directories

- `src/main/java/dk/mosberg/mana/` — Mana logic
- `src/main/java/dk/mosberg/config/ManaConfig.java` — Config system
- `src/client/java/dk/mosberg/client/overlay/` — HUD overlays
- `src/client/java/dk/mosberg/client/renderer/` — Rendering helpers
- `README.md` — Build, dependency, and mod metadata
- `build.gradle`, `gradle.properties` — Build config

## Examples

- To add a new mana type, extend `ManaPool` and update overlays.
- To add a config option, add a getter/setter in `ManaConfig` and document the key.
- To add a new HUD element, create a class in `overlay/` and register it in `ManaClient`.

---

For more, see the [README.md](../README.md) and code comments in each module.
